(()=>{"use strict";new class{constructor(){this.sidebarElem=document.querySelector(".page__sidebar"),this.spacingElem=document.querySelector(".page__spacing"),this.stickyMargin=0,this.spacing=0,this.prevScrollY=0,this.prevScrollDirection="down",this.currentScrollDirection="down",this.setEventListeners()}setEventListeners(){window.addEventListener("DOMContentLoaded",this.onDOMLoaded),window.addEventListener("resize",this.onResize),window.addEventListener("scroll",function(i,t){let e=!1;return(...t)=>{e||(i(...t),e=!0,setTimeout((()=>{e=!1}),undefined))}}(this.onScroll))}onDOMLoaded=()=>{this.setStickyMargin(),this.stickyMargin<=0?this.setSidebarElemPosition("fixed"):this.setSidebarElemPosition("sticky","top")};onResize=()=>{if(this.setStickyMargin(),this.stickyMargin<=0)this.setSidebarElemPosition("fixed");else{switch(this.prevScrollDirection){case"down":this.setSidebarElemPosition("sticky","top");break;case"up":this.setSidebarElemPosition("sticky","bottom");break;default:throw new Error("invalid scroll direction")}this.setSpacing(),this.setSpacingElemMarginTop()}};onScroll=()=>{if("fixed"!==this.sidebarElem.style.positon&&this.isScrollDirectionChanged()){switch(this.currentScrollDirection){case"down":this.setSidebarElemPosition("sticky","top");break;case"up":this.setSidebarElemPosition("sticky","bottom");break;default:throw new Error("invalid scroll direction")}this.setSpacing(),this.setSpacingElemMarginTop()}};setStickyMargin(){const i=Math.floor(this.sidebarElem.getBoundingClientRect().height),t=window.innerHeight;this.stickyMargin=i-t}setSpacing(){const i=window.scrollY,t=Math.abs(Math.floor(this.sidebarElem.getBoundingClientRect().y));this.spacing=i-t}isScrollDirectionChanged(){this.setCurrentScrollDirection();const i=this.currentScrollDirection!==this.prevScrollDirection;return this.setPrevScrollDirection(),i}setCurrentScrollDirection(){const i=window.scrollY;this.currentScrollDirection=i>=this.prevScrollY?"down":"up",this.prevScrollY=i}setPrevScrollDirection(){this.prevScrollDirection=this.currentScrollDirection}setSidebarElemPosition(i,t){switch(this.sidebarElem.style.position=i,i){case"fixed":this.sidebarElem.style.top="0",this.sidebarElem.style.bottom=null;break;case"sticky":this.sidebarElem.style[t]=`-${this.stickyMargin}px`,this.sidebarElem.style["up"===t?"down":"up"]=null;break;default:throw new Error("invalid position")}}setSpacingElemMarginTop(){this.spacingElem.style.marginTop=`${this.spacing}px`}}})();
//# sourceMappingURL=main.js.map